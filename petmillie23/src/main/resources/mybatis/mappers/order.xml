<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="mapper.order">
<!-- 리절트 맵 정의 -->	
	<resultMap id="orderGoodsResult" type="OrderVO">
	    <result property="order_num" column="order_num" />
		<result property="order_id" column="order_id" />
		<result property="member_id" column="member_id" />
		<result property="goods_num" column="goods_num" />
		<result property="goods_name" column="goods_name" />
		<result property="goods_sales_price" column="goods_sales_price" />
		<result property="total_price" column="total_price" />
		<result property="goods_qty" column="goods_qty" />
		
		<result property="zipcode" column="zipcode" />
		<result property="roadAddress" column="roadAddress" />
		<result property="jibunAddress" column="jibunAddress" />
		<result property="namujiAddress" column="namujiAddress" />
		<result property="receiver_name" column="receiver_name" />

		<result property="total_price" column="total_price" />
		<result property="tel1" column="tel1" />
		<result property="tel2" column="tel2" />
		<result property="tel3" column="tel3" />
		<result property="delivery_message" column="delivery_message" />
		
		<result property="delivery_method" column="delivery_method" />
		<result property="pay_method" column="pay_method" />
		<result property="card_com_name" column="card_com_name" />
		<result property="card_pay_month" column="card_pay_month" />
		
		<result property="pay_order_tel" column="pay_order_tel" />
		<result property="pay_order_time" column="pay_order_time" />
		<result property="delivery_state" column="delivery_state" />
		<result property="final_total_price" column="final_total_price" />
		<result property="goods_fileName" column="goods_fileName" />
	</resultMap>

	
	 <select id="selectMyOrderList" resultMap="orderGoodsResult"  parameterType="orderVO">
	    <![CDATA[
			select * from userorder
			where DATE(pay_order_time) = CURDATE()
	    	and member_id=#{member_id}
	    	order by pay_order_time desc
		]]>
	</select>
	<insert id="insertNewOrder" parameterType="orderVO" useGeneratedKeys="true" keyProperty="order_num">
    <![CDATA[
		insert into userorder(
		member_id, goods_num, goods_name, goods_fileName, goods_qty, goods_sales_price, order_name, receiver_name,
		tel1, tel2, tel3, zipcode, roadAddress, jibunAddress, namujiAddress, delivery_message, delivery_method, pay_method,
		card_com_name, card_pay_month, pay_order_tel, final_total_price, total_price)
		values(
		#{member_id}, #{goods_num},  #{goods_name}, #{goods_fileName}, #{goods_qty}, #{goods_sales_price}, #{order_name},
		#{receiver_name}, #{tel1}, #{tel2}, #{tel3}, #{zipcode}, #{roadAddress}, #{jibunAddress}, #{namujiAddress}, #{delivery_message},
		#{delivery_method}, #{pay_method}, #{card_com_name}, #{card_pay_month}, #{pay_order_tel}, #{final_total_price}, #{total_price})
	]]>
	</insert>
<!-- <insert id="insertOrderID" useGeneratedKeys="true" keyProperty="id">
	    INSERT INTO userorder(order_num) VALUES (NULL)
	</insert>  -->
  <!--  <select id="selectOrderID" resultType="int"  >
	    <![CDATA[
		    select seq_order_id.nextval from dual
    	]]>
	</select>
	 -->
	<select id="selectMyOrder" resultMap="orderGoodsResult"   parameterType="String"  >
	    <![CDATA[
		    select * from t_shopping_order
            where DATE(pay_order_time) = CURDATE()
            and order_id=#{order_id}
            order by pay_order_time desc
    	]]>
	</select>
	
	<delete id="deleteGoodsFromCart" parameterType="orderVO">
	  delete from cart
	  where goods_num=#{goods_num}
	</delete>
	
</mapper>
